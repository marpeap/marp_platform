# Configuration Vercel - Site Statique Marpeap Digitals

## Configuration essentielle pour site statique HTML/CSS/JS

### vercel.json - Configuration requise

```json
{
  "version": 2,
  "framework": null,           // CRITIQUE: Empêche auto-détection Next.js
  "buildCommand": null,        // CRITIQUE: Pas de build nécessaire
  "installCommand": null,      // CRITIQUE: Pas d'installation nécessaire
  "outputDirectory": ".",
  "headers": [...],
  "rewrites": [...],
  "cleanUrls": true,
  "trailingSlash": false
}
```

### Points critiques

1. **framework: null** : ESSENTIEL pour empêcher Vercel d'auto-détecter Next.js
   - Sans cela, Vercel cherche routes-manifest.json et échoue
   - Erreur typique: "The file /vercel/path0/routes-manifest.json couldn't be found"

2. **buildCommand: null** : Désactive la commande de build
   - Évite que Vercel exécute "npm run build" qui pourrait déclencher Next.js

3. **installCommand: null** : Désactive l'installation de dépendances
   - Pas nécessaire pour un site statique pur

4. **Patterns de routes** : DOIVENT utiliser syntaxe path-to-regexp, PAS regex JavaScript
   - ❌ INCORRECT: `/(.*)` 
   - ✅ CORRECT: `/:path*`
   - ❌ INCORRECT: `/css/(.*)`
   - ✅ CORRECT: `/css/:path*`
   - ❌ INCORRECT: `/(.*\\.(html|htm))`
   - ✅ CORRECT: `/:path*.html` et `/:path*.htm` (séparés)

### package.json - Configuration minimale

```json
{
  "name": "marpeap-digitals",
  "version": "2.1.0",
  "private": true,
  "description": "Site vitrine statique pour Marpeap Digitals",
  "scripts": {
    "build": "echo 'Static site - no build needed'"
  }
}
```

### Erreurs courantes et solutions

1. **"routes-manifest.json couldn't be found"**
   - Cause: Vercel détecte Next.js automatiquement
   - Solution: Ajouter `"framework": null` dans vercel.json

2. **"Invalid route source pattern"**
   - Cause: Utilisation de regex JavaScript au lieu de path-to-regexp
   - Solution: Convertir tous les patterns (ex: `/(.*)` → `/:path*`)

3. **"Couldn't find any pages or app directory"**
   - Cause: Vercel essaie de builder comme Next.js
   - Solution: `framework: null`, `buildCommand: null`, `installCommand: null`

### Structure de fichiers requise

```
/
├── index.html          # Fichier principal (requis)
├── vercel.json        # Configuration Vercel (requis)
├── package.json       # Configuration npm (requis)
├── css/
├── js/
└── assets/
```

### Headers de sécurité configurés

- X-Content-Type-Options: nosniff
- X-Frame-Options: SAMEORIGIN
- X-XSS-Protection: 1; mode=block
- Referrer-Policy: strict-origin-when-cross-origin

### Cache Control

- CSS/JS/HTML: `max-age=0, must-revalidate` (pas de cache)
- Images: `max-age=31536000, immutable` (cache long terme)

### Documentation Vercel

- Patterns routes: https://vercel.com/docs/errors/error-list#invalid-route-source-pattern
- Syntaxe path-to-regexp obligatoire pour tous les patterns source
